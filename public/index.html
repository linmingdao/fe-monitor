<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>前端监控</title>
    <!-- <script>
      window.addEventListener(
        "error",
        function (event) {
          console.log(event);
        },
        true
      );
    </script> -->
  </head>
  <body style="background-color: rgb(125, 125, 125); color: #fff">
    <div id="container">
      <div class="content">
        <input
          id="jsErrorBtn"
          type="button"
          value="点击抛出js错误"
          onclick="jsErrorClick()"
        />
        <input
          id="promiseBtn"
          type="button"
          value="点击抛出promise错误"
          onclick="promiseErrorClick()"
        />
      </div>
      <div id="blank-content" style="word-break: break-all; color: #000"></div>
    </div>
    <script>
      function jsErrorClick() {
        window.someVar.error = "error";
      }

      function promiseErrorClick() {
        new Promise((resolve, reject) => {
          window.someVar.error = "error";
          // reject("error");
        })
          // .catch((err) => console.log(err))
          .finally(() => console.log())
          .then((result) => console.log(result));
      }
    </script>
    <script>
      document.getElementById("blank-content").innerHTML = "@".repeat(9999);
      // DOM解析完成，即使依赖的资源文件未加载完成也会触发该事件
      document.addEventListener("DOMContentLoaded", () => {
        const start = Date.now();
        while (Date.now() - start < 1000) {}
      });
      document.addEventListener("load", () => {
        const start = Date.now();
        while (Date.now() - start < 3000) {}
      });
      setTimeout(() => {
        const content = document.getElementsByClassName("content")[0];
        const h1 = document.createElement("h1");
        h1.innerHTML = "我是这个页面最右意义的内容";
        // 通过elementtiming属性手动指定页面最右意义元素
        h1.setAttribute("elementtiming", "meaningful");
        content.appendChild(h1);
      }, 2000);
    </script>
    <script type="application/javascript" src="someError.js"></script>
  </body>
</html>
